<!DOCTYPE html>
<html>
	<head>
		<title>周边吐槽</title>
		<!--
		This template can be used for creating apps that require user login and user registration before starting actual app.
		-->
		<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=0;" />

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<link rel="stylesheet" type="text/css" href="build/css/icons.css" />
		<link rel="stylesheet" type="text/css" href="build/css/af.ui.css"  />

        <script src="build/require.js" data-main="js/main"></script>

		<script type="text/javascript" src="http://api.map.baidu.com/api?type=quick&ak=VWt0QeFL3rjEI29tyiAldir9&v=1.0"></script>

		<link rel="stylesheet" type="text/css" href="build/css/ionicons.css" />
		<link rel="stylesheet" type="text/css" href="main.css" />

        <!-- template starts here -->
		<script id="tpl" type="text/template">
			{@each data as tucao,index}
			<div style="border-bottom: 1px solid #dddddd;background: #eeeeee">
			<table style="width:100%;">
				<tr>
					<td align="left" valign="top" style="font-size: 10px;padding: 5px" onclick="detail (${tucao.TUCAO_ID})">
						<span>${tucao.CONTENT}</span>
					</td>
					<td style="width: 40px">
						<div align="center" style="width: 100%">
							<div onclick="upClick(this);" style="font-size: 0px">
								<img src="icons/ios7-arrow-up.png" width="30px" height="25px"/>
							</div>
							<div style="font-size: 12px">
								<span>0</span>
							</div>
							<div onclick="downClick(this);" style="font-size: 0px">
								<img src="icons/ios7-arrow-down.png" width="30px" height="25px"/>
							</div>
						</div>
					</td>
				</tr>
			</table>
			<table style="width: 100%;height: 20px;font-size: 8px;padding-right: 40px">
				<tr>
					<td width="25%" style="padding-left: 5px">
						<span>${tucao.CREATE_TIME|jsDateDiff}</span>
					</td>
					<td width="25%" align="center">
						<span>${tucao.distanceFrom}</span>
					</td>
					<td width="25%" align="center">
						<i class="icon mail"></i>
						<span>${tucao.COMMENT_NUM}</span>
					</td>
					<td width="25%" align="right">
						<span>${tucao.user_name}</span>
					</td>
				</tr>
			</table>
			</div>
			{@/each}

		</script>
		<script id="tplBlock" type="text/template">
			<div class="colum">
				<div class="content">
					<div class="words">
					<	span>${CONTENT}</span>
					</div>
					<div class="detail">
						<span>200m</span>
						<a class="icon message" style="margin-left: 20%"></a>
						<span>30</span>
						<span style="margin-left: 40%">2小时前</span>
					</div>
				</div>
				<div class="score">
					<div class="uparrow" onclick="upClick(this);">
						<a class="icon up small" ></a>
					</div>
					<div class="num">
						<span>100</span>
					</div>
					<div class="uparrow">
						<a class="icon down small" ></a>
					</div>
				</div>
			</div>
		</script>

		<script id="tplComment" type="text/template">
			{@each data as comment,index}
			<div style="border-bottom: 1px solid #dddddd;background: #ffffff">
			<table style="width: 100%;">
				<tr>
					<td rowspan="2" width="30px" style="margin-right: 5px">
						<img src=${comment.comment_content|random29} width="25px" height="25px"/>
					</td>
					<td height="15px" style="font-size: 8px;color: #999999">
						<span>${comment.user_name}</span>
						<span style="margin-left:20px">${comment.create_time|jsDateDiff}</span>
					</td>
					<td rowspan="2" width="40px">
						<div align="center" style="width: 100%">
							<div onclick="upClick(this);" style="font-size: 0px">
								<img src="icons/ios7-arrow-up.png" width="30px" height="20px"/>
							</div>
							<div style="font-size: 8px">
								<span>??</span>
							</div>
							<div onclick="downClick(this);" style="font-size: 0px">
								<img src="icons/ios7-arrow-down.png" width="30px" height="20px"/>
							</div>
						</div>
					</td>
				</tr>
				<tr>
					<td align="left" style="font-size: 10px;vertical-align: middle">
						<span>${comment.comment_content}</span>
					</td>
				</tr>
			</table>
			</div>
			{@/each}
		</script>

        <script>
            //******此段定义常量********//
            var userId = 2;
            var distance = 1500;
            var FIRST_LENGTH = 10;
            var newTucaoId =-1;
            var position = {
                coords : {
                    latitude : 31.274913,
                    longitude : 120.755755
                }
            };
            //gc的经纬度：
			var position2 = {
				coords : {
					latitude : 118.766414,
					longitude : 31.834680
				}
			};
            // var webRoot = "http://127.0.0.1/Web/tucao/index.php?r=tc_users/";
            var webRoot = "http://127.0.0.1/tucao/index.php/";
            var map = null;
            var curTucaoId = 8;

        </script>

	</head>
	<body>
		<div id="afui">
			<div id="content" style="">
				<!-- Views -->

				<div class="panel" id="loginPanel" title="登录" data-defer="loginPanel.html" data-footer="none" data-header="none"></div>

				<div class="panel" id="signupPanel" title="注册" data-defer="signupPanel.html" data-footer="none" ></div>

				<div class="panel" id="hotMain" title="热门吐槽" data-load="startHot" data-footer="foot" data-header="head" style="overflow:hidden;padding: 0px">
					<div id="hotmap"></div>
				</div>

				<div class="panel" id="newMain" title="最新吐槽" selected="true" data-load="startNew"  data-footer="foot" data-header="head"></div>
				<div class="panel" id="tucaoPanel" title="查看吐槽" data-defer="tucaoPanel.html" data-load="startTucao" data-unload="closeTucao" data-header="headDetail" data-footer="commentFoot" ></div>
				<div class="panel" id="chatPanel" title="私信" data-defer="chatPanel.html" data-header="headChat" data-footer="foot" ></div>
				<div class="panel" id="editPanel" title="编辑吐槽" data-defer="editPanel.html" data-load="startEdit" data-header="headEdit" data-footer="none"></div>
					
				<div class="panel" id="discoveryPanel" title="发现" data-defer="discoveryPanel.html" data-load="startDiscovery" data-footer="foot" ></div>
				
				<div class="panel" id="messagePanel" title="消息" data-load="" data-footer="foot" ></div>
				
				<div class="panel" id="userPanel" title="用户管理" data-defer="userPanel.html" data-load="startUser" data-header="none" data-footer="foot" ></div>
					<div class="panel" id="mylistPanel" title="我发表的吐槽" data-load="startMylist" data-footer="foot" ></div>
					<div class="panel" id="mycommentPanel" title="我评论过的吐槽" data-load="startMycomment" data-footer="foot" ></div>
			</div>

			<header id="head" style="height: 100%">
				<table style="width:100%; height: 100%">
					<tr>
						<td width="40px" align="center">
							<a class="ion-xbox" style="font-size: 30px"></a>
						</td>
						<td align="center">
							<a class="" href="#hotMain">热点吐槽</a>
							<a class="" href="#newMain">最新吐槽</a>
						</td>
						<td width="40px" align="center">
							<a class="ion-plus" style="font-size: 30px" href="#editPanel"></a>
						</td>
					</tr>
				</table>
			</header>
			<footer id="foot">
				<a class="icon home" style="font-size: 10px" href="#newMain">主页</a>
				<a class="icon magnifier" style="font-size: 10px" href="#discoveryPanel">发现</a>
				<a id="messageIcon" class="icon message" style="font-size: 10px" href="#messagePanel">消息</a>
				<a class="icon user" style="font-size: 10px" href="#userPanel">我</a>
			</footer>
	</body>
</html>
